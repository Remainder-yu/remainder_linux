# 页表

## 统一的页表框架
页表是用于把虚拟地址映射至物理地址，并且存放页的保护位，即访问权限。
linux内存把页表分为4级。
1. 页全局页表（Page GLobal Directory，PGD）
2. 页上层页表（Page Upper Directory,PUD）
3. 页中间目录（Page Middle Directory，PMD）
4. 直接页表（Page Table， PT）

可以通过配置宏`CONFIG_PAGEABLE_LEVELS`配置页表的级数，一般使用默认值。

内核也有一个页表，0号内核线程的进程描述符init_task的成员active_mm指向内存描述符init_mm,内存描述符init_mm的成员pgd指向内核的页全局目录swapper_pg_dir。

查询页表，把虚拟地址转化为物理地址过程如下：
1. 根据页全局目录的起始地址和页全局目录索引得到页全局目录表项的地址，然后从表项得到页上层目录的起始地址。
2. 根据页上层的目录起始地址和页上层目录索引得到页上层目录表项的地址，然后从表项得到页中间目录的起始地址。
3. 根据页中间目录的起始地址和页中间目录索引得到页中间目录表项的地址，然后从表项得到直接页表的起始地址
4. 根据直接页表的起始地址和直接页表索引得到页表项的地址，然后从页表项得到页帧号。
5. 从页帧号和页内偏移组合成物理地址


